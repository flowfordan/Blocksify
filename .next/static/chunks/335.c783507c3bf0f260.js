(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{8092:function(e,t,n){"use strict";n.r(t),n.d(t,{AppPage:function(){return tq}});var r,o,a,s,i,l,c,d,u,p,m,_,f,h,b=n(1309),g=n(5893),v=n(6670),j=n(7294),y=n(8564),O=n(5079),P=n(9477),w=n(9365),E=n(1764),C=function(){var e=new P.CP7({antialias:!0});return e.shadowMap.enabled=!0,e.outputEncoding=P.knz,e.setSize(window.innerWidth,window.innerHeight),e},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)throw Error("Renderer is not defined");switch(t){case 0:var n=e.domElement.width/e.domElement.height,r=new P.iKG(-(200*n/2),200*n/2,100,-100,1,1e4);return r.position.set(0,100,0),r.lookAt(0,0,0),r;case 1:var o=new P.cPb(75,e.domElement.width/e.domElement.height,.1,2e3);return o.position.set(50,60,50),o;default:return new P.cPb}},M=n(4805),S=new P.DvJ(10,10,10),B=new P.Wid({color:12829635,wireframe:!1}),L=new P.Kj0(S,B);L.castShadow=!0,L.position.set(0,5,20),L.name="test_cube";var I=new P.TOt(L.geometry),k=new P.nls({color:0}),x=new P.ejS(I,k);L.add(x);var N=new M.L1;N.setPositions([10,.02,10,10,.02,25]);var A=new M.L1;A.setPositions([5,.02,10,5,.02,45,20,.02,20]);var D=new M.YR({color:10,linewidth:2,resolution:new P.FM8(640,480),dashed:!0,dashScale:2,dashSize:2,gapSize:1}),R=new M.w_(N,D);R.name="test_line";var J=new M.w_(A,D);R.computeLineDistances(),J.computeLineDistances();var G=new P.Pa4(1,0,0),F=new P.FM8,V=new P.Pa4,z={ground:"#F0EFEE",street_axis:"#747474",street_border:"#7A6F61",border_path:"#3F5462",border_fill:"#CDCDCD",block_fill_r:"#FFFB8F",block_border_r:"#FFFB8F",block_fill_g:"#B5F16A",block_border_g:"#B5F16A",common_points:"#747474"},Y=new P.BKK(2e3,2e3,8,8),U=new P.Wid({color:z.ground,side:P.ehD}),X=new P.Kj0(Y,U);X.rotateX(-Math.PI/2),X.receiveShadow=!0,X.name="ground",X.position.y=-.015;var K=new P.JOQ(new P.Pa4(0,1,0),0),H=new P.tJx(K,1,16776960),W=new P.Ox3(16777215,1);W.color.setHSL(.1,1,.95),W.position.set(-1,5,5),W.position.multiplyScalar(30),W.castShadow=!0,W.shadow.bias=1e-4,W.shadow.mapSize.width=4096,W.shadow.mapSize.height=4096,W.shadow.camera.top=100,W.shadow.camera.bottom=-100,W.shadow.camera.left=100,W.shadow.camera.right=-100;var Z=new P.cBI(W,5),Q=new P.PMe(void 0,5);Q.position.set(-125,125,-12.5),Q.castShadow=!0,Q.shadow.mapSize.width=4096,Q.shadow.mapSize.height=4096,Q.shadow.radius=1,Q.intensity=1,new P.FvO(Q,5);var q=new P.vmT(8765406,16777215,.8);q.position.set(0,50,0);var $=n(8949),ee=n(2722),et=function e(t,n,r){var o=this;(0,y._)(this,e),this.setCamera=function(e){e===ee.A2.TOP?(o.camera=T(o.rendererController.renderer,0),o.controls=new w.z(o.camera,o.rendererController.activeElement),o.controls.enableRotate=!1,o.layersModel.layers.forEach(function(e){return o.camera.layers.enable(e._id)})):(o.camera=T(o.rendererController.renderer,1),o.controls=new w.z(o.camera,o.rendererController.activeElement),o.layersModel.layers.forEach(function(e){return o.camera.layers.enable(e._id)}))},this.cameraZoom=function(){o.camera.translateZ(20)},this.setLayersVisibility=function(){o.layersModel.layers.forEach(function(e){e.visible?o.camera.layers.enable(e._id):o.camera.layers.disable(e._id)})},this.toggleLayerVisibility=function(e){var t=o.layersModel.layers.find(function(t){return t._id===e});if(!t)throw Error("Trying to find layer to set visibility. \n        There is no layer with such id");t.visible?o.camera.layers.enable(t._id):o.camera.layers.disable(t._id)},this.updOnResize=function(e,t){o.camera instanceof P.cPb?o.camera.aspect=e:(o.camera.left=-(e*t/2),o.camera.right=e*t/2,o.camera.top=t/2,o.camera.bottom=-(t/2)),o.camera.updateProjectionMatrix()},this._storeSubscribe=function(){(0,$.U5)(function(){var e=[],t=o.layersModel.layers,n=!0,r=!1,a=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value;e.push(l.visible)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return e},function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]!==t[r]){var a=o.layersModel.layers[r];o.toggleLayerVisibility(a._id);break}})},this.rendererController=t,this.layersModel=n,this.cameraModel=r,this.camera=T(),this.controls=new w.z(this.camera,t.activeElement),this.setCamera(r.currentCameraId),this._storeSubscribe()};function en(e){return!!e.OBJ_GENERAL_TYPE&&e.OBJ_GENERAL_TYPE===s.OBJ_MAIN}function er(e){return!!e.OBJ_GENERAL_TYPE&&e.OBJ_GENERAL_TYPE===s.OBJ_PRIM_PT}function eo(e){return!!e.OBJ_GENERAL_TYPE&&e.OBJ_GENERAL_TYPE===s.OBJ_SEGMENT_LINE}(r=a||(a={})).point_segment="point_segment",r.line_segment="line_segment",r.polygon_segment="polygon_segment",(o=s||(s={})).OBJ_MAIN="OBJ_MAIN",o.OBJ_TEMP="OBJ_TEMP",o.OBJ_PRIM_PT="OBJ_PRIM_PT",o.OBJ_SECOND_PT="OBJ_SECOND_PT",o.OBJ_SEGMENT="OBJ_SEGMENT",o.OBJ_SEGMENT_LINE="OBJ_SEGMENT_LINE",o.OBJ_SEGMENT_POINT="OBJ_SEGMENT_POINT",o.OBJ_SEGMENT_POLYGON="OBJ_SEGMENT_POLYGON";var ea=function e(t){var n=this;(0,y._)(this,e),this.toggleInstrumentActive=function(e){n.instrumentsModel.toggleInstrumentActive(e)},this.setInstrumentAvailable=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];n.instrumentsModel.setInstrumentsAvailable(e,t)},this.setSelectorIntersectedObjData=function(e){e?en(e.userData)&&n.instrumentsModel.setInstrumentData(e.userData,ee.aU.INSPECTOR,"int"):n.instrumentsModel.setInstrumentData(null,ee.aU.INSPECTOR,"int")},this.setSelectorSelectedObjData=function(e){e?en(e.userData)&&n.instrumentsModel.setInstrumentData(e.userData,ee.aU.INSPECTOR,"sel"):n.instrumentsModel.setInstrumentData(null,ee.aU.INSPECTOR,"sel")},this.instrumentsModel=t},es=n(5766),ei=n(2253),el=n(4932),ec=n(7702),ed=n(4184),eu=n.n(ed),ep=n(3370),em=n.n(ep),e_=function(e){var t=Float32Array.from(e),n=new P.u9r;n.setAttribute("position",new P.TlE(t,3));var r=new P.UY4({color:8947848,size:6,sizeAttenuation:!1});return new P.woe(n,r)},ef=function(e,t){return e.map(function(e){return[e.toArray()[0],0-t,e.toArray()[1]]}).flat()},eh=new P.UY4({color:8947848,size:6,sizeAttenuation:!1}),eb=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;return new M.YR({color:new P.Ilk(e||z.common_points),linewidth:t,resolution:new P.FM8(1920,1080),dashed:n,dashSize:o,gapSize:a,opacity:r})},eg=function(e){return new P.vBJ({color:new P.Ilk(e||"moccasin"),side:P.ehD,transparent:!0,opacity:.5})},ev={OBJ_GENERAL_TYPE:s.OBJ_MAIN,layerId:{editType:"constant",value:2},objName:{editType:"constant",value:"Border",pubTitle:"name"},objArea:{editType:"calculated",value:0,pubTitle:"area"},objMaxFloors:{editType:"editable",value:0,pubTitle:"max floors"},objMinFloors:{editType:"editable",value:0,pubTitle:"min floors"}},ej={OBJ_GENERAL_TYPE:s.OBJ_MAIN,layerId:{editType:"constant",value:3},objName:{editType:"constant",value:"Street",pubTitle:"name"},objLength:{editType:"calculated",value:0,pubTitle:"length"},objWidth:{editType:"editable",value:10,pubTitle:"width"}},ey={OBJ_GENERAL_TYPE:s.OBJ_MAIN,layerId:{editType:"constant",value:4},objName:{editType:"constant",value:"Block",pubTitle:"name"},objArea:{editType:"calculated",value:0,pubTitle:"area"}},eO={OBJ_GENERAL_TYPE:s.OBJ_MAIN,layerId:{editType:"constant",value:5},objName:{editType:"constant",value:"Building",pubTitle:"name"},objFloors:{editType:"calculated",value:0,pubTitle:"floors"}},eP={_id:0,_name:"Border",_descr:"Border or/and Zone inside Border ",_stage:0,_mat:{line:eb(z.border_path,5,!0),polygon:eg(z.border_fill)}},ew={_id:0,_name:"Street axis",_descr:"Street axis",_stage:0,_mat:{line:eb(z.street_axis,2,!0,1,4,2),polygon:eg()}},eE={_id:0,_name:"Street sides",_descr:"Street sides",_stage:0,_mat:{line:eb(z.street_border),polygon:eg()}},eC={_id:1,_name:"Block area",_descr:"Block area territory",_stage:1,_mat:{line:eb(5454129),polygon:eg()}},eT={_id:1,_name:"Building",_descr:"Building volume",_stage:1,_mat:{line:eb(5454129),polygon:eg()}},eM={_name:"Init",_id:0,active:!1,empty:!0,editable:!1,visible:!1,blocked:!0,_disabledInstruments:[],_contentConfig:(i={},(0,es._)(i,s.OBJ_PRIM_PT,null),(0,es._)(i,s.OBJ_SECOND_PT,null),i),objsQuantity:0,objDefaultData:ev,ptsData:{main:{OBJ_GENERAL_TYPE:s.OBJ_PRIM_PT},add:{OBJ_GENERAL_TYPE:s.OBJ_SECOND_PT}},_creationObjsConfig:(l={},(0,es._)(l,s.OBJ_PRIM_PT,null),(0,es._)(l,s.OBJ_SECOND_PT,null),l)},eS=[{_name:"Borders",_id:2,active:!1,empty:!0,editable:!0,visible:!0,blocked:!1,_disabledInstruments:[ee.aU.LINE,ee.aU.PLINE],_contentConfig:(c={},(0,es._)(c,s.OBJ_PRIM_PT,eP),(0,es._)(c,s.OBJ_SECOND_PT,null),c),objsQuantity:0,objDefaultData:ev,ptsData:{main:{OBJ_GENERAL_TYPE:s.OBJ_PRIM_PT},add:{OBJ_GENERAL_TYPE:s.OBJ_SECOND_PT}},_creationObjsConfig:(d={},(0,es._)(d,s.OBJ_PRIM_PT,null),(0,es._)(d,s.OBJ_SECOND_PT,null),d)},{_name:"Streets",_id:3,active:!1,empty:!0,editable:!0,visible:!0,blocked:!1,_disabledInstruments:[ee.aU.POLYGON],_contentConfig:(u={},(0,es._)(u,s.OBJ_PRIM_PT,ew),(0,es._)(u,s.OBJ_SECOND_PT,eE),u),objsQuantity:0,objDefaultData:ej,ptsData:{main:{OBJ_GENERAL_TYPE:s.OBJ_PRIM_PT},add:{OBJ_GENERAL_TYPE:s.OBJ_SECOND_PT}},_creationObjsConfig:(p={},(0,es._)(p,s.OBJ_PRIM_PT,null),(0,es._)(p,s.OBJ_SECOND_PT,{creationType:"generation_on_add",triggeredByLayerChange:null,generationTemplate:"parallel"}),p)},{_name:"Blocks",_id:4,active:!1,empty:!0,editable:!1,visible:!0,blocked:!0,_disabledInstruments:[],_contentConfig:(m={},(0,es._)(m,s.OBJ_PRIM_PT,null),(0,es._)(m,s.OBJ_SECOND_PT,eC),m),objsQuantity:0,objDefaultData:ey,ptsData:{main:{OBJ_GENERAL_TYPE:s.OBJ_PRIM_PT},add:{OBJ_GENERAL_TYPE:s.OBJ_SECOND_PT}},_creationObjsConfig:(_={},(0,es._)(_,s.OBJ_PRIM_PT,null),(0,es._)(_,s.OBJ_SECOND_PT,null),_)},{_name:"Buildings",_id:5,active:!1,empty:!0,editable:!1,visible:!1,blocked:!0,_disabledInstruments:[],_contentConfig:(f={},(0,es._)(f,s.OBJ_PRIM_PT,null),(0,es._)(f,s.OBJ_SECOND_PT,eT),f),objsQuantity:0,objDefaultData:eO,ptsData:{main:{OBJ_GENERAL_TYPE:s.OBJ_PRIM_PT},add:{OBJ_GENERAL_TYPE:s.OBJ_SECOND_PT}},_creationObjsConfig:(h={},(0,es._)(h,s.OBJ_PRIM_PT,null),(0,es._)(h,s.OBJ_SECOND_PT,null),h)}],eB=new function e(){var t=this;(0,y._)(this,e),this.init=function(){console.log("init layer 2"),t.toggleActiveLayer(2)},this.setCurrentLayer=function(e){if(e)return t.currentLayer=e,e;var n=t.layers.find(function(e){return e.active});if(!n)throw Error("No active layers");return n},this.toggleActiveLayer=function(e){var n=t.layers.find(function(t){return t._id===e});if(n){if(!n.editable){console.log("exit");return}var r=t.layers.find(function(e){return e.active});if(r){var o=t.layers.indexOf(r);t.layers[o].active=!1}var a=t.layers.indexOf(n);t.layers[a].active=!0,t.currentLayer=t.layers[a]}},this.setLayerVisibility=function(e){var n=t.layers.findIndex(function(t){return t._id===e});n>-1&&(t.layers[n].visible=!t.layers[n].visible)},this.setIsLayerEmpty=function(e,n){var r=t.layers.find(function(e){return e._id===n});r&&(r.empty=e)},this.setLayerObjectsNumber=function(e,n){var r=t.layers.find(function(t){return t._id===e});r&&(r.objsQuantity=r.objsQuantity+n)},this.getLayerById=function(e){return t.layers.find(function(t){return t._id===e})||null},this.layers=eS,this.currentLayer=eM,(0,$.ky)(this)},eL=n(8132),eI=function(e){var t,n=e.layerId,r=e.name,o=e.isEmpty,a=e.isActive,s=e.isVisible,i=e.isBlocked,l=e.numOfObjs,c=(0,ec._)(e,["layerId","name","isEmpty","isActive","isVisible","isBlocked","numOfObjs"]),d=function(){eB.setLayerVisibility(n)},u=function(){eB.toggleActiveLayer(n)};return(0,g.jsxs)("div",(0,el._)((0,ei._)({className:eu()(em().layersListItem,(t={},(0,es._)(t,em().active,a),(0,es._)(t,em().hidden,!s),(0,es._)(t,em().blocked,i),t))},c),{children:[(0,g.jsx)("span",{className:em().emptyStatus,children:o?null:(0,g.jsx)("span",{className:em().nonEmptyBadge})}),(0,g.jsxs)("span",{className:em().name,onClick:function(){return u()},children:[(0,g.jsx)("span",{children:r}),(0,g.jsx)("span",{className:eu()(em().name__counter,(0,es._)({},em().hidden,0===l)),children:l})]}),i?(0,g.jsx)("span",{className:em().iconContainer,children:(0,g.jsx)(eL.JO,{name:"lock",size:16})}):null,(0,g.jsx)("span",{className:em().iconContainer,onClick:function(){return d()},children:s?(0,g.jsx)(eL.JO,{name:"eye",size:16}):(0,g.jsx)(eL.JO,{name:"eyeClosed",size:16})})]}))},ek=n(9436),ex=n(2267),eN=[{id:"start",order:0,title:"start",status:"completed"},{id:"bordered",order:1,title:"bordered",status:"current"},{id:"divided",order:2,title:"divided",status:"not_started"},{id:"blocksified",order:3,title:"blocksyfied",status:"not_started"}],eA=new(function(){function e(){var t=this;(0,y._)(this,e),this.stages=eN,this.toggleCoordsFetching=function(e){t._isFetchingPointerCoords=e,e||(t.currentPointerCoordsGlobal.x=0,t.currentPointerCoordsGlobal.y=0,t.currentPointerCoordsGlobal.z=0)},this.setPointerCoords=function(e){t.currentPointerCoordsGlobal.x=e.x,t.currentPointerCoordsGlobal.y=e.y,t.currentPointerCoordsGlobal.z=e.z},this.setStageNext=function(){for(var e=0,n=0;n<t.stages.length;n++)"current"===t.stages[n].status&&(e=n,t.stages[n].status="completed");t.stages[e+1].status="current"},this.setStagePrev=function(){for(var e=t.stages.length-1;e>-1;e--)if("current"===t.stages[e].status){t.stages[e].status="not_started",t.stages[e-1].status="current";break}},this.resetStagesToStart=function(){for(var e=0;e<t.stages.length;e++)0===e?t.stages[e].status="current":t.stages[e].status="not_started"},this._isFetchingPointerCoords=!0,this.currentPointerCoordsGlobal={x:0,y:0,z:0},this.baseDirection=new P.Pa4(1,0,0),(0,$.ky)(this)}return(0,ex._)(e,[{key:"currentStage",get:function(){return this.stages.find(function(e){return"current"===e.status})}}]),e}()),eD=(0,v.Pi)(function(e){var t=e.coord,n=e.value,r=e.fixValue,o=void 0===r?2:r,a="".concat(n.toFixed(o>20||o<20?2:o));return(0,g.jsxs)("div",{className:"coordUnit",children:[(0,g.jsx)("span",{children:"".concat(t,":")}),(0,g.jsx)("span",{children:a})]})}),eR=n(9798),eJ=n.n(eR),eG=(0,v.Pi)(function(){var e=eA.currentPointerCoordsGlobal;return(0,g.jsxs)("div",{className:eJ().coordsPanel,children:[(0,g.jsx)("span",{className:eJ().coordsPanel__cell,children:(0,g.jsx)(eD,{coord:"X",value:e.x})}),(0,g.jsx)("span",{className:eJ().coordsPanel__cell,children:(0,g.jsx)(eD,{coord:"Y",value:e.z})}),(0,g.jsx)("span",{className:eJ().coordsPanel__cell,children:(0,g.jsx)(eD,{coord:"Z",value:e.y})})]})}),eF=new function e(){var t=this;(0,y._)(this,e),this.currentTask=null,this.setCurrentTask=function(e,n,r){t.currentTask={creationType:e.creationType,template:e.generationTemplate,inputObj:n,objLayerId:r},console.log("start task",Date.now())},this.cleanTask=function(){t.currentTask=null,console.log("end task",Date.now())},(0,$.ky)(this)},eV=new function e(t,n,r,o){(0,y._)(this,e),this.layersModel=t,this.instrumentsModel=n,this.sceneModel=r,this.generatorModel=o}(eB,ek.T0,eA,eF),ez=function e(){var t=this;(0,y._)(this,e),this.toggleLayerActive=function(e){eV.layersModel.toggleActiveLayer(e)},this._setIsLayerEmpty=function(e){var t=eV.layersModel,n=t.layers.find(function(t){return t._id===e});if(!n)throw Error("Cant find Layer");n.objsQuantity<1?t.setIsLayerEmpty(!0,e):t.setIsLayerEmpty(!1,e)},this.updLayerObjsCount=function(e,n){eV.layersModel.setLayerObjectsNumber(n,e),t._setIsLayerEmpty(n)}},eY=function(){function e(){(0,y._)(this,e),this.setPointerCoords=function(e){eV.sceneModel.setPointerCoords(e)}}return e.prototype.setStage=function(e,t,n){var r=eV.sceneModel.currentStage;if(!r)throw Error("No current stage");switch(r.id){case"bordered":2===e&&1===t&&n&&eV.sceneModel.setStageNext();break;case"divided":3===e&&2===t&&n&&eV.sceneModel.setStageNext();break;case"blocksified":3!==e||1!==t||n||(console.log("SET PREV STAGE"),eV.sceneModel.setStagePrev())}},e}(),eU=new P.iMs;function eX(e,t,n,r,o){e.preventDefault();var a=e.clientX-t.left,s=e.clientY-t.top;return F.x=a/n.width*2-1,F.y=-(2*(s/n.height))+1,eU.setFromCamera(F,r),eU.ray.intersectPlane(o,V),V}eU.params={Mesh:{threshold:1},Line:{threshold:.5},LOD:{},Points:{threshold:1},Sprite:{threshold:1}},eU.params.Line2={threshold:25};var eK=function e(){var t=this;(0,y._)(this,e),this.initTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){t.trackObjs.polygon.geom=new P.bnF;var n=new P.oa8(t.trackObjs.polygon.geom);t.trackObjs.polygon.form=new P.Kj0(n,t.trackObjs.polygon.mat),t.trackObjs.polygon.form.name="track-polygon",t.trackObjs.polygon.form.rotateX(Math.PI/2)}t.trackObjs.line.geom=new M.L1,t.trackObjs.line.form=new M.w_(t.trackObjs.line.geom,t.trackObjs.line.mat),t.trackObjs.line.form.name="track-line"},this.updTrack=function(e){t.trackObjs.line.geom.setPositions(e),t.trackObjs.line.form.computeLineDistances()},this.updTrackPolygon=function(e,n,r){t.trackObjs.polygon.geom=new P.bnF,t.trackObjs.polygon.geom.moveTo(e.x,e.y),t.trackObjs.polygon.geom.lineTo(r.x,r.z),t.trackObjs.polygon.geom.lineTo(n.x,n.y),t.trackObjs.polygon.form=new P.Kj0(new P.oa8(t.trackObjs.polygon.geom),t.trackObjs.polygon.mat),t.trackObjs.polygon.form.rotateX(Math.PI/2)},this.initOverlayObj=function(e,n){if(e instanceof M.w_){var r;(r="temp"===n?t.overlayObjTemp:t.overlayObjPerm).form=e.clone(),r.form.renderOrder=-1,r.form.layers.set(0),r.form.material=r.mat}},this.trackObjs={line:{form:new M.w_,geom:new M.L1,mat:new M.YR},polygon:{form:new P.Kj0,geom:new P.bnF,mat:new P.vBJ}},this.overlayObjTemp={form:new M.w_,geom:new M.L1,mat:new M.YR},this.overlayObjPerm={form:new M.w_,geom:new M.L1,mat:new M.YR},this.trackObjs.line.mat=new M.YR({color:952801,linewidth:2,resolution:new P.FM8(1920,1080),dashed:!0,opacity:.8}),this.trackObjs.polygon.mat=new P.vBJ({color:new P.Ilk("skyblue"),side:P.ehD,transparent:!0,opacity:.5}),this.overlayObjTemp.mat=new M.YR({color:8505852,linewidth:10,resolution:new P.FM8(1920,1080),dashed:!1,opacity:1}),this.overlayObjPerm.mat=new M.YR({color:16602710,linewidth:10,resolution:new P.FM8(1920,1080),dashed:!1,opacity:1})},eH=n(4586),eW=function e(){var t=this;(0,y._)(this,e),this.setSegmentInitProperties=function(e,t){switch(t){case"common":var n={OBJ_GENERAL_TYPE:s.OBJ_SEGMENT};e.userData=Object.assign(n);break;case"point":var r={OBJ_GENERAL_TYPE:s.OBJ_SEGMENT_POINT};e.userData=Object.assign(r);break;case"line":var o={OBJ_GENERAL_TYPE:s.OBJ_SEGMENT_LINE};e.userData=Object.assign(o);break;case"polygon":var a={OBJ_GENERAL_TYPE:s.OBJ_SEGMENT_POLYGON};e.userData=Object.assign(a)}},this.setObjInitProperties=function(e,t,n){if("main"===n){var r=(0,$.ZN)(t.objDefaultData);e.userData=Object.assign(r),e.name=r.objName.value}else if("pt_prim"===n){var o=(0,$.ZN)(t.ptsData.main);e.userData=Object.assign(o)}else if("pt_second"===n){var a=(0,$.ZN)(t.ptsData.add);e.userData=Object.assign(a)}},this.updObjAutoProps=function(e,n){var r=e.userData;if(en(r))for(var o in r){var a=r[o];if("object"==typeof a){if("calculated"!==a.editType)continue;var s=t._tempCalcObjPhysProp(e,o);s&&(a.value=s)}}},this._tempCalcObjPhysProp=function(e,t){for(var n=0;n<e.children.length;n++)if(er(e.children[n].userData)){for(var r,o=e.children[n],a=0;a<o.children.length;a++)if("objArea"===t){if((r=o.children[a].userData).OBJ_GENERAL_TYPE&&r.OBJ_GENERAL_TYPE===s.OBJ_SEGMENT_POLYGON){for(var i=o.children[a].geometry.attributes.position.array,l=[],c=0;c<i.length;c+=3)l.push(new P.FM8(i[c],i[c+1]));var d=Math.abs(P.iDF.area(l));return console.log(d),d}}else if("objLength"===t&&eo(o.children[a].userData)){var u=o.children[a];u.computeLineDistances();for(var p=0,m=u.geometry.attributes.instanceStart.array,_=0;_<m.length;_+=6){var f=new P.Pa4(m[_],0,m[_+2]),h=new P.Pa4(m[_+3],0,m[_+5]);p+=f.distanceTo(h)}return p}}}},eZ=function e(){var t=this;(0,y._)(this,e),this.createLine=function(e,n){if(!n._contentConfig.OBJ_PRIM_PT)throw Error("Layer doesnt have options to enable drawing on it");t.objParts.line.mat=n._contentConfig.OBJ_PRIM_PT._mat.line,t.objParts.line.geom=new M.L1,t.objParts.line.form=new M.w_(t.objParts.line.geom,t.objParts.line.mat),t.objParts.points.form=e_(e),t.propsEditor.setSegmentInitProperties(t.objParts.line.form,"line"),t.propsEditor.setSegmentInitProperties(t.objParts.points.form,"point"),t.objCreated.add(t.objParts.points.form),t.objCreated.add(t.objParts.line.form),t.objCreated.layers.set(n._id),t.objParts.line.form.layers.set(n._id),t.objParts.points.form.layers.set(n._id),t.objCreated.name=n._name,t.propsEditor.setObjInitProperties(t.objMain,n,"main"),t.propsEditor.setObjInitProperties(t.objCreated,n,"pt_prim"),t.objMain.add(t.objCreated)},this.createPolygon=function(e,n,r){if(!n._contentConfig.OBJ_PRIM_PT)throw Error("Layer doesnt have options to enable drawing on it");t.objParts.polygon.geom=new P.bnF;var o=new P.oa8(t.objParts.polygon.geom);t.objParts.polygon.mat=n._contentConfig.OBJ_PRIM_PT._mat.polygon,t.objParts.polygon.form=new P.Kj0(o,t.objParts.polygon.mat),t.objParts.polygon.form.rotateX(Math.PI/2),t.objParts.polygon.geom.moveTo(r.x,r.z),t.objParts.points.form=e_(e),t.objParts.line.mat=n._contentConfig.OBJ_PRIM_PT._mat.line,t.objParts.line.geom=new M.L1,t.objParts.line.form=new M.w_(t.objParts.line.geom,t.objParts.line.mat),t.propsEditor.setSegmentInitProperties(t.objParts.line.form,"line"),t.propsEditor.setSegmentInitProperties(t.objParts.points.form,"point"),t.propsEditor.setSegmentInitProperties(t.objParts.polygon.form,"polygon"),t.objCreated.add(t.objParts.points.form),t.objCreated.add(t.objParts.line.form),t.objCreated.add(t.objParts.polygon.form),t.objCreated.layers.set(n._id),t.objParts.line.form.layers.set(n._id),t.objParts.points.form.layers.set(n._id),t.objParts.polygon.form.layers.set(n._id),t.objCreated.name=n._name,t.propsEditor.setObjInitProperties(t.objMain,n,"main"),t.propsEditor.setObjInitProperties(t.objCreated,n,"pt_prim"),console.log(t.objCreated),t.objMain.add(t.objCreated)},this.updateLine=function(e,n){if(!t.objParts.line.geom||!t.objParts.line.form)throw Error("There is no Obj Form or Obj Geometry in Tool");0===e?t.objParts.line.geom.setPositions(n):(t.objParts.line.form.geometry=new M.L1,t.objParts.line.form.geometry.setPositions(n)),t.objParts.line.form.computeLineDistances();var r=Float32Array.from(n);t.objParts.points.form.geometry.setAttribute("position",new P.TlE(r,3)),t.isRenderable=!0},this.updatePolygon=function(e,n){if(!t.objParts.line.geom||!t.objParts.line.form||!t.objParts.polygon.geom||!t.objParts.polygon.form)throw Error("There is no Obj Form or Obj Geometry in Tool");if(e.length<6){t.objParts.polygon.geom.lineTo(n.x,n.z),t.objParts.polygon.form.geometry=new P.oa8(t.objParts.polygon.geom);return}t.objParts.polygon.geom.lineTo(n.x,n.z),t.objParts.polygon.form.geometry=new P.oa8(t.objParts.polygon.geom);var r=ef(t.objParts.polygon.geom.getPoints(),0),o=Float32Array.from(r);t.objParts.points.form.geometry.setAttribute("position",new P.TlE(o,3)),t.objParts.line.form.geometry=new M.L1,t.objParts.line.form.geometry.setPositions(e),t.objParts.line.form.computeLineDistances(),t.isRenderable=!0},this.initTemp=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n?(t.tempObjs.polygon.form=e.form.clone(),t.tempObjs.polygon.form.name="temp"):(t.tempObjs.line.form=e.form.clone(),t.tempObjs.line.form.name="temp")},this.reset=function(){t.objMain=new P.Tme,t.objCreated=new P.Tme,t.objParts.line.form=new M.w_,t.objParts.line.geom=new M.L1,t.objParts.polygon.form=new P.Kj0,t.objParts.polygon.geom=new P.bnF,t.objParts.points.form=null,t.isRenderable=!1},this.objMain=new P.Tme,this.objCreated=new P.Tme,this.objParts={line:{form:new M.w_,geom:new M.L1,mat:eb()},points:{form:null,geom:null,mat:eh},polygon:{form:new P.Kj0,geom:new P.bnF,mat:eg()}},this.tempObjs={line:{form:new M.w_,geom:new M.L1,mat:new M.YR},polygon:{form:new P.Kj0,geom:new P.bnF,mat:new P.vBJ}},this.isRenderable=!1,this.propsEditor=new eW},eQ={main:function e(t){var n=this;(0,y._)(this,e),this.createObj=function(e,t,r,o){"line"===e?(n.objBuilder.createLine(t,r),n.createTemp()):"polygon"===e&&o&&(n.objBuilder.createPolygon(t,r,o),n.createTemp(!0))},this.getObjPolygonPoints=function(){if(!n.objBuilder.objParts.polygon.geom)throw Error("No current Polygon was created");return n.objBuilder.objParts.polygon.geom.getPoints()},this.updObj=function(e,t,r){"line"===e?n.objBuilder.updateLine(0,t):"pline"===e?(n.objBuilder.updateLine(1,t),n.updTemp("pline")):"polygon"===e&&r&&(n.objBuilder.updatePolygon(t,r),n.updTemp("polygon"))},this.renderObj=function(){n.objBuilder.isRenderable&&n.sceneModifier.addObj(n.objBuilder.objMain)},this.removeObj=function(){n.sceneModifier.removeObj(n.objBuilder.objMain)},this.reset=function(){n.objBuilder.reset(),n.removeTemp()},this.createTemp=function(e){n.objBuilder.initTemp(n.objBuilder.objParts.line),e&&n.objBuilder.initTemp(n.objBuilder.objParts.polygon,e)},this.updTemp=function(e){n.removeTemp(),n.objBuilder.tempObjs.line.form=n.objBuilder.objParts.line.form.clone(),n.objBuilder.tempObjs.line.form.name="temp","polygon"===e&&(n.objBuilder.tempObjs.polygon.form=n.objBuilder.objParts.polygon.form.clone(),n.objBuilder.tempObjs.polygon.form.name="temp"),n.renderTemp("polygon"===e)},this.renderTemp=function(e){n.sceneModifier.addObj(n.objBuilder.tempObjs.line.form),e&&n.sceneModifier.addObj(n.objBuilder.tempObjs.polygon.form)},this.removeTemp=function(){n.sceneModifier.removeObj(n.objBuilder.tempObjs.line.form),n.sceneModifier.removeObj(n.objBuilder.tempObjs.polygon.form)},this.objBuilder=new eZ,this.sceneModifier=t},fx:function e(t){var n=this;(0,y._)(this,e),this.createTrack=function(e){n.fxBuilder.initTrack(e)},this.updTrack=function(e){n.fxBuilder.updTrack(e)},this.updTrackPolygon=function(e,t,r){n.sceneModifier.removeObj(n.fxBuilder.trackObjs.polygon.form),n.fxBuilder.updTrackPolygon(e,t,r)},this.renderTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&n.sceneModifier.addObj(n.fxBuilder.trackObjs.polygon.form),n.sceneModifier.addObj(n.fxBuilder.trackObjs.line.form)},this.removeTrack=function(){n.sceneModifier.removeObj(n.fxBuilder.trackObjs.line.form),n.sceneModifier.removeObj(n.fxBuilder.trackObjs.polygon.form)},this.createOverlayObj=function(e,t){e&&(n.fxBuilder.initOverlayObj(e,t),n.renderOverlayObj(t))},this.renderOverlayObj=function(e){"temp"===e?n.sceneModifier.addObj(n.fxBuilder.overlayObjTemp.form):n.sceneModifier.addObj(n.fxBuilder.overlayObjPerm.form)},this.removeOverlayObj=function(e){"temp"===e?n.sceneModifier.removeObj(n.fxBuilder.overlayObjTemp.form):("perm"===e||n.sceneModifier.removeObj(n.fxBuilder.overlayObjTemp.form),n.sceneModifier.removeObj(n.fxBuilder.overlayObjPerm.form))},this.fxBuilder=new eK,this.sceneModifier=t},tags:function(){function e(t){(0,y._)(this,e),this.sceneModifier=t}var t=e.prototype;return t.createObj=function(){throw Error("Method not implemented.")},t.updObj=function(){throw Error("Method not implemented.")},t.renderObj=function(){throw Error("Method not implemented.")},t.removeObj=function(){throw Error("Method not implemented.")},t.reset=function(){throw Error("Method not implemented.")},e}(),helpers:function e(t){var n=this;(0,y._)(this,e),this.renderHelperLabel=function(e,t,r){switch(t){case ee.mO.SNAP_GRID:n.renderedGuidesOptions.points.material.color=new P.Ilk(10987431);break;case ee.mO.SNAP_STEP:n.renderedGuidesOptions.points.material.color=new P.Ilk(6080255);break;case ee.mO.SNAP_ANGLE:if(n.renderedGuidesOptions.points.material.color=new P.Ilk(6080255),r){console.log("FIXED",r);var o=new P.Pa4;o.subVectors(e,r).setLength(1e4).add(r);var a=r.clone().lerp(o,-1);n.renderedGuidesOptions.lines.geometry.setPositions((0,eH._)(a.toArray()).concat((0,eH._)(o.toArray())));var s=new P.Pa4(1,0,0);s.setLength(1e4).add(r);var i=r.clone().lerp(s,-1);n.renderedGuidesOptions.mainLine.geometry.setPositions((0,eH._)(i.toArray()).concat((0,eH._)(s.toArray()))),n.sceneModifier.addObj(n.renderedGuidesOptions.lines.form),n.sceneModifier.addObj(n.renderedGuidesOptions.mainLine.form)}break;case"":return;default:n.renderedGuidesOptions.points.material.color=new P.Ilk(10987431);return}n.renderedGuidesOptions.points.geometry.setFromPoints([e]),n.sceneModifier.addObj(n.renderedGuidesOptions.points.form)},this._loadInitGuidesOptions=function(){var e={points:{form:new P.woe,geometry:new P.u9r,material:new P.UY4({color:6080255,size:11,sizeAttenuation:!1,opacity:.5,transparent:!0})},lines:{form:new M.w_,geometry:new M.L1,material:eb(16723759)},mainLine:{form:new M.w_,geometry:new M.L1,material:eb(16745347,2,!1,.8)}};return e.points.material.depthWrite=!1,e.points.material.depthTest=!1,e.points.form=new P.woe(e.points.geometry,e.points.material),e.lines.form=new M.w_(e.lines.geometry,e.lines.material),e.mainLine.form=new M.w_(e.mainLine.geometry,e.mainLine.material),e},this.removeRenderedLabels=function(){n.sceneModifier.removeObj(n.renderedGuidesOptions.lines.form),n.sceneModifier.removeObj(n.renderedGuidesOptions.points.form),n.sceneModifier.removeObj(n.renderedGuidesOptions.mainLine.form)},this.sceneModifier=t,this.renderedGuidesOptions=this._loadInitGuidesOptions()}},eq=function(){function e(){(0,y._)(this,e)}return e.prototype.createObjManager=function(e){return eQ[e]},e}(),e$=function(e){if(en(e.userData)){var t=e.children.find(function(e){return er(e.userData)});if(t)return t.children.find(function(e){return eo(e.userData)})}},e0=function(){function e(t,n,r){var o=this;(0,y._)(this,e),this.start=function(e,t,n){o.currentCamera=e,o.currentLayer=n,o.canvas.addEventListener("mousemove",o._onMouseMove),o.canvas.addEventListener("click",o._onClick),window.addEventListener("keydown",o._onKey),o.toolState=1},this._onMouseMove=function(e){if(!o.currentLayer)throw Error("Layer is not specified");var t,n=function(e,t,n,r,o,a){t.preventDefault(),eU.layers.set(a);var s=t.clientX-n.left,i=t.clientY-n.top;F.x=s/r.width*2-1,F.y=-(2*(i/r.height))+1,eU.setFromCamera(F,o);var l=eU.intersectObjects(e.children);if(l.length>0)return l[0].object}(o.objManager.sceneModifier.scene,e,o.rect,o.canvas,o.currentCamera,o.currentLayer._id);if(o.objManagerFX.removeOverlayObj("temp"),o.intersectedObj=null,n){if(en(n.userData))o.intersectedObj=n;else if(!er(n.userData)&&((t=n.userData).OBJ_GENERAL_TYPE&&t.OBJ_GENERAL_TYPE===s.OBJ_SECOND_PT?0:1)){if(eo(n.userData)){if(!n.parent)return;o.intersectedObj=n.parent.parent}}else o.intersectedObj=n.parent;if(o.intersectedObj){var r=e$(o.intersectedObj);o.objManagerFX.createOverlayObj(r,"temp")}}},this._onClick=function(){if(o.objManagerFX.removeOverlayObj("perm"),o.selectedObj=null,o.intersectedObj){o.selectedObj=o.intersectedObj;var e=e$(o.selectedObj);o.objManagerFX.createOverlayObj(e,"perm")}},this._onKey=function(e){("Delete"===e.key||"Backspace"===e.key)&&o.selectedObj&&(o.objManager.sceneModifier.removeObj(o.selectedObj),o.objManagerFX.removeOverlayObj("all"),o.selectedObj=null)},this.stop=function(){console.log("SELECTOR END"),o.objManagerFX.removeOverlayObj("all"),o.selectedObj=null,o.intersectedObj=null,o.canvas.removeEventListener("mousemove",o._onMouseMove),o.canvas.removeEventListener("click",o._onClick),window.removeEventListener("keydown",o._onKey)},this.canvas=t,this.rect=t.getBoundingClientRect(),this.currentCamera=new P.cPb,this.currentLayer=null,this._selectedObj=null,this._intersectedObj=null,this.renderedObjs={selectedObj:null,selectedPoints:null,intersectedObj:null},this.toolState=0;var a=new eq;this.objManager=new(a.createObjManager("main"))(n),this.objManagerFX=new(a.createObjManager("fx"))(n),this.adapter=r}return(0,ex._)(e,[{key:"selectedObj",get:function(){return this._selectedObj},set:function(e){this._selectedObj=e,this.adapter.setSelectorSelectedObjData(e)}},{key:"intersectedObj",get:function(){return this._intersectedObj},set:function(e){this._intersectedObj=e,this.adapter.setSelectorIntersectedObjData(e)}}]),e}(),e1=n(2678),e2=n(1861),e4=n(7669),e5=n(4165),e3=n(8007),e8=n(1068),e6=function(){function e(t){var n=this;(0,y._)(this,e),this.renderTag=function(e,t,r){var o,a;(o=n.sceneModifier).removeObjs.apply(o,(0,eH._)(n.toolTags.lengths).concat((0,eH._)(n.toolTags.angles)));for(var s=0;s<e.length;s++)n.toolTags.lengths[s]=new E.j(n.tagContainers.lengths[s]),n.tagContainers.lengths[s].textContent="".concat(e[s].distanceTo(t).toFixed(2)," m"),n.toolTags.lengths[s].position.lerpVectors(e[s],t,.5);if(r&&r.snap_angle.isActive){for(var i,l=[],c=0;c<e.length;c++){l[c]=new P.Pa4,l[c].subVectors(e[c],t);var d=n.baseDirection.angleTo(l[c])*(180/Math.PI);n.toolTags.angles[c]=new E.j(n.tagContainers.angles[c]),n.tagContainers.angles[c].textContent="".concat(d.toFixed(0)," \xb0"),n.toolTags.angles[c].position.lerpVectors(e[c],t,-.02)}(i=n.sceneModifier).addObjs.apply(i,(0,eH._)(n.toolTags.angles))}(a=n.sceneModifier).addObjs.apply(a,(0,eH._)(n.toolTags.lengths))},this.stopRender=function(){var e;(e=n.sceneModifier).removeObjs.apply(e,(0,eH._)(n.toolTags.lengths).concat((0,eH._)(n.toolTags.angles)))},this.sceneModifier=t,this.baseDirection=G,this.tagContainers={lengths:[],angles:[]},this.toolTags={lengths:[],angles:[]},this.initContainers()}return e.prototype.initContainers=function(){var e=document.createElement("div");e.className="label",e.style.marginTop="-1em";for(var t=0;t<2;t++)this.tagContainers.lengths[t]=e.cloneNode(!0),this.tagContainers.angles[t]=e.cloneNode(!0)},e}(),e7=function e(t,n){var r=this;(0,y._)(this,e),this.start=function(){r.snapStatuses=r._createDefaultStatuses(r.helpersModel.helpers)},this.snapToCoords=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(Object.values(r.snapStatuses).every(function(e){return!1===e.isActive}))return e;for(var o in r.snapStatuses)r.snapStatuses[o].snappedCoords=e;r.snapStatuses.snap_grid.isActive&&r._snapToGrid(e),r.snapStatuses.snap_step.isActive&&t>1&&r._snapToStep(e,n),r.snapStatuses.snap_angle.isActive&&t>1&&r._snapToAngle(e,n);var a=e,s=1/0,i="";for(var l in r.snapStatuses){var c=r.snapStatuses[l];c.isActive&&c.distToOrigin<=s&&(s=c.distToOrigin,a=c.snappedCoords,i=l,c.isCurrent=!0,r.currentSnapping=l)}return r.objManagerHelpers.renderHelperLabel(a,i,n),a},this._snapToGrid=function(e){var t=e.clone(),n=r.helpersModel._getItem(ee.mO.SNAP_GRID);if(!n)throw Error("SnapManager: Cant find grid helper options");var o=n.options.value,a=function(e,t){return t<1?Math.round(2*e)/2:Math.round(e/t)*t};t.x=a(t.x,o),t.z=a(t.z,o),r.snapStatuses.snap_grid.snappedCoords=t,r.snapStatuses.snap_grid.distToOrigin=e.distanceTo(t)},this._snapToStep=function(e,t){if(t){var n=e.clone(),o=r.helpersModel._getItem(ee.mO.SNAP_STEP);if(!o)throw Error("SnapManager: Cant find Step helper options");var a=o.options.value,s=t.distanceTo(e);(n=new P.Pa4).subVectors(e,t).setLength(Math.round(s/a)*a).add(t);var i=e.distanceTo(n);r.snapStatuses.snap_step.snappedCoords=n,r.snapStatuses.snap_step.distToOrigin=i}},this._snapToAngle=function(e,t){if(t){if(!r.helpersModel._getItem(ee.mO.SNAP_ANGLE))throw Error("Snap Manager error - couldnt find angle snap options");var n=r.helpersModel.anglesSnapV3s;if(!n)throw Error("Snap Manager error - couldnt get V3 collection");if(0===Object.keys(n).length){console.log("Angles for snapping werent chosen, angle snap is off");return}var o=e.clone().sub(t.clone()),a=r.baseVector.angleTo(o)*(180/Math.PI),s=e.z>t.z,i=new P.Pa4,l=360,c=!0,d=!1,u=void 0;try{for(var p,m=Object.entries(n)[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var _=(0,b._)(p.value,2),f=_[0];_[1];var h=Math.abs(a-parseInt(f));h<l&&(l=h,i=s?n[f][0]:n[f][1])}}catch(e){d=!0,u=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw u}}var g=i.clone().setLength(t.distanceTo(e)).clone().add(t),v=e.distanceTo(g);r.snapStatuses.snap_angle.snappedCoords=g,r.snapStatuses.snap_angle.distToOrigin=v}},this._createDefaultStatuses=function(e){return e.filter(function(e){return"snapping"===e.type}).reduce(function(e,t){var n={isActive:t.isActive,snappedCoords:new P.Pa4,distToOrigin:1/0,isCurrent:!1};return(0,el._)((0,ei._)({},e),(0,es._)({},t.id,n))},{})},this._resetStatuses=function(){var e=!0,t=!1,n=void 0;try{for(var o,a=Object.entries(r.snapStatuses)[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var s=(0,b._)(o.value,2),i=s[0],l=s[1];r.snapStatuses[i].isActive=l.isActive,r.snapStatuses[i].distToOrigin=1/0,r.snapStatuses[i].snappedCoords=new P.Pa4,r.snapStatuses[i].isCurrent=!1}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}},this.resetSnap=function(){r.objManagerHelpers.removeRenderedLabels(),r.currentSnapping=null,r._resetStatuses()},this.helpersModel=n,this.sceneModifier=t,this.currentSnapping=null,this.snapStatuses=this._createDefaultStatuses(n.helpers),this.baseVector=G;var o=new eq;this.objManagerHelpers=new(o.createObjManager("helpers"))(t)},e9=function(){function e(t,n,r){(0,y._)(this,e),this.canvas=t,this.rect=t.getBoundingClientRect(),this.layer=null,this.toolState=0,this.currentCamera=null,this.currentPlane=null,this.currentPointerCoord=new P.Pa4,this.objCoords=[],this.tagsManager=new e6(n),this.snapManager=new e7(n,r);var o=new eq;this.objManager=new(o.createObjManager("main"))(n),this.objManagerFX=new(o.createObjManager("fx"))(n)}var t=e.prototype;return t.start=function(e,t,n){this.toolState=1,this.layer=n,this.currentCamera=e,this.currentPlane=t},t._resetLoop=function(e){this.toolState=1,this.objCoords=[]},t.stop=function(){this.toolState=0},e}(),te=function(e){(0,e3._)(n,e);var t=(0,e8._)(n);function n(e,r,o,a){var s;return(0,y._)(this,n),(s=t.call(this,e,o,a)).start=function(e,t,r){(0,e4._)(((0,e1._)(s),(0,e5._)(n.prototype)),"start",s).call(s,e,t,r),s.snapManager.start(),s.canvas.addEventListener("mousemove",s._onMouseMove),s.canvas.addEventListener("click",s._onDrawClick),s.canvas.addEventListener("dblclick",s._onDBClick),window.addEventListener("keypress",s._onKey)},s._onMouseMove=function(e){var t=eX(e,s.rect,s.canvas,s.currentCamera,s.currentPlane);if(s.currentPointerCoord=t,1===s.toolState&&(s.currentPointerCoord=s.snapManager.snapToCoords(t)),2===s.toolState){0===s.lineMode?s.objCoords.length=3:1===s.lineMode&&(s.objCoords.length=3*s.lineSegments),s.currentPointerCoord=s.snapManager.snapToCoords(t,2,(0,e2._)(P.Pa4,(0,eH._)(s.objCoords.slice(3*s.lineSegments-3))));var n,r=Object.values(s.currentPointerCoord);(n=s.objCoords).push.apply(n,(0,eH._)(r));var o=s.objCoords.slice(3*s.lineSegments-3);s.objManagerFX.updTrack(o),s.objManagerFX.renderTrack(),s.tagsManager.renderTag([(0,e2._)(P.Pa4,(0,eH._)(o.slice(0,3)))],s.currentPointerCoord,s.snapManager.snapStatuses)}},s._onDrawClick=function(){if(1===s.toolState){s.objManager.createObj("line",s.objCoords,s.layer);var e,t=Object.values(s.currentPointerCoord);(e=s.objCoords).push.apply(e,(0,eH._)(t)),s.objManagerFX.createTrack(),s.toolState=2}else 2===s.toolState&&(0===s.lineMode?s.objManager.updObj("line",s.objCoords):s.objManager.updObj("pline",s.objCoords),0===s.lineMode?s._resetLoop():(s.toolState=2,s.lineSegments++,s.tagsManager.stopRender()),s.objManagerFX.removeTrack())},s._onKey=function(e){"Enter"===e.key&&s._resetLoop()},s._onDBClick=function(e){e.preventDefault(),s.objCoords.length,s._resetLoop()},s.stop=function(){(0,e4._)(((0,e1._)(s),(0,e5._)(n.prototype)),"stop",s).call(s),s.objManager.removeObj(),s._resetLoop(!0),s.canvas.removeEventListener("mousemove",s._onMouseMove),s.canvas.removeEventListener("click",s._onDrawClick),s.canvas.removeEventListener("dblclick",s._onDBClick),window.removeEventListener("keypress",s._onKey)},s._resetLoop=function(e){(0,e4._)(((0,e1._)(s),(0,e5._)(n.prototype)),"_resetLoop",s).call(s,e),e||s.objManager.renderObj(),s.objManager.reset(),s.objManagerFX.removeTrack(),s.tagsManager.stopRender(),s.snapManager.resetSnap(),s.lineSegments=1},s.lineMode=r,s.lineSegments=1,s}return n}(e9),tt=function(e){(0,e3._)(n,e);var t=(0,e8._)(n);function n(e,r,o){var a;return(0,y._)(this,n),(a=t.call(this,e,r,o)).start=function(e,t,r){(0,e4._)(((0,e1._)(a),(0,e5._)(n.prototype)),"start",a).call(a,e,t,r),a.canvas.addEventListener("mousemove",a._onMouseMove),a.canvas.addEventListener("click",a._onDrawClick),a.canvas.addEventListener("dblclick",a._onDBClick),window.addEventListener("keypress",a._onEnter)},a._onMouseMove=function(e){var t=eX(e,a.rect,a.canvas,a.currentCamera,a.currentPlane);if(a.currentPointerCoord=t,2===a.toolState){var n=Object.values(a.currentPointerCoord);if(a.objCoords.length<=6){var r=(0,eH._)(a.objCoords).concat((0,eH._)(n),(0,eH._)(n));a.objManagerFX.updTrack(r),a.objManagerFX.renderTrack(),a.tagsManager.renderTag([(0,e2._)(P.Pa4,(0,eH._)(a.objCoords))],a.currentPointerCoord)}else{var o=a.objManager.getObjPolygonPoints(),s=o[0],i=o[o.length-1],l=ef([s],a.currentPlane.constant),c=ef([i],a.currentPlane.constant),d=(0,eH._)(l).concat((0,eH._)(n),(0,eH._)(c));a.objManagerFX.updTrackPolygon(s,i,a.currentPointerCoord),a.objManagerFX.updTrack(d),a.objManagerFX.renderTrack(!0),a.tagsManager.renderTag([(0,e2._)(P.Pa4,(0,eH._)(l)),(0,e2._)(P.Pa4,(0,eH._)(c))],a.currentPointerCoord)}}},a._onDrawClick=function(){if(1===a.toolState){var e,t=Object.values(a.currentPointerCoord);(e=a.objCoords).push.apply(e,(0,eH._)(t)),a.objManager.createObj("polygon",a.objCoords,a.layer,a.currentPointerCoord),a.objManagerFX.createTrack(!0),a.toolState=2}else if(2===a.toolState){a.objManager.updObj("polygon",a.objCoords,a.currentPointerCoord),a.objCoords.length=0;var n,r,o=ef(a.objManager.getObjPolygonPoints(),a.currentPlane.constant);(n=a.objCoords).push.apply(n,(0,eH._)(o)),(r=a.objCoords).push.apply(r,(0,eH._)(a.objCoords.slice(0,3))),a.objManager.updObj("polygon",a.objCoords,a.currentPointerCoord),a.tagsManager.stopRender(),a.objManagerFX.removeTrack()}},a._onDBClick=function(){console.log("Double CLICK? What did you expect?")},a._onEnter=function(e){"Enter"===e.key&&a._resetLoop()},a._resetLoop=function(e){(0,e4._)(((0,e1._)(a),(0,e5._)(n.prototype)),"_resetLoop",a).call(a,e),e||a.objManager.renderObj(),a.objManager.reset(),a.objManagerFX.removeTrack(),a.tagsManager.stopRender()},a.polygonParts=1,a}return n.prototype.stop=function(){(0,e4._)((0,e5._)(n.prototype),"stop",this).call(this),this.objManager.removeObj(),this._resetLoop(!0),this.canvas.removeEventListener("mousemove",this._onMouseMove),this.canvas.removeEventListener("click",this._onDrawClick),this.canvas.removeEventListener("dblclick",this._onDBClick),window.removeEventListener("keypress",this._onEnter)},n}(e9),tn=function(){function e(){(0,y._)(this,e)}var t=e.prototype;return t.setGenerationTask=function(e,t,n){console.log("mediator set task",e,t);var r=eV.layersModel.getLayerById(t);if(r){console.log("CONFIG",r);var o=r._creationObjsConfig.OBJ_SECOND_PT;console.log("CONFIG",o),o&&eV.generatorModel.setCurrentTask(o,e,t)}},t.endTask=function(){eV.generatorModel.cleanTask()},e}(),tr=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0;o<n.length;o++)n[o].layers.set(e)},to=function(e){var t=Float32Array.from(e),n=new P.u9r;n.setAttribute("position",new P.TlE(t,3));var r=new P.UY4({color:z.common_points,size:2,sizeAttenuation:!1});return new P.woe(n,r)},ta=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=e.children.find(function(e){if(er(e.userData))return!0});if(r){var o=r.clone(!1);o.name="temp sub part";var a=r.children.find(function(e){if(eo(e.userData))return!0}),i=r.children.find(function(e){var t;if((t=e.userData).OBJ_GENERAL_TYPE&&t.OBJ_GENERAL_TYPE===s.OBJ_SEGMENT_POINT)return!0});if(a&&i){for(var l=i.geometry.attributes.position,c=[],d=0;d<2;d++){var u=new P.Pa4;u.fromBufferAttribute(l,d),c.push(u)}for(var p=to([]),m=to([]),_=new Float32Array(6),f=new Float32Array(6),h=new P.Pa4(0,1,0),b=0;b<c.length;b++){var g=new P.Pa4().clone();g.subVectors(c[0],c[1]).cross(h).normalize().multiplyScalar(n),g.add(c[b]),_.set(g.toArray(),3*b)}for(var v=0;v<c.length;v++){var j=new P.Pa4().clone();j.subVectors(c[0],c[1]).cross(h).normalize().multiplyScalar(-n),j.add(c[v]),f.set(j.toArray(),3*v)}p.geometry.setAttribute("position",new P.TlE(_,3)),m.geometry.setAttribute("position",new P.TlE(f,3));var y=new M.w_(new M.L1,eb(z.street_border,2.5,!1,.9));y.geometry.setPositions(_);var O=new M.w_(new M.L1,eb(z.street_border,2.5,!1,.9));return O.geometry.setPositions(f),o.add(p,m),o.add(y,O),tr(t,p,m,y,O),e.add(o),!0}}},ts=function(){function e(){(0,y._)(this,e),this.generatorAdapter=new tn}return e.prototype.createParallelLines=function(e,t){ta(e,t)},e}(),ti=function e(t,n,r,o,a,s,i){var l=this;(0,y._)(this,e),this.startInstrCont=function(e,t,n,r){var o;null===(o=l.instruments[e.id])||void 0===o||o.start(r,n,t),document.body.style.cursor=e.activeCursor,window.addEventListener("keydown",l.onExit)},this.stopInstrCont=function(e){var t;null===(t=l.instruments[e])||void 0===t||t.stop(),document.body.style.cursor="auto"},this.onExit=function(e){if("Escape"===e.key){var t=l.instrumentsModel.instruments.find(function(e){return e.isActive&&"continous"===e.activity&&"top"===e.lvl});t&&(l.adapter.toggleInstrumentActive(t.id),window.removeEventListener("keydown",l.onExit))}},this.updateCurrentCamera=function(e){var t=l.instrumentsModel.instruments.find(function(e){return e.isActive&&"continous"===e.activity});t&&l.adapter.toggleInstrumentActive(t.id),l.currentCamera=e},this._storeSubscribe=function(){(0,$.U5)(function(){return l.instrumentsModel.instruments.find(function(e){return e.isActive&&"continous"===e.activity})},function(e,t,n){t&&l.stopInstrCont(t.id),e&&l.startInstrCont(e,l.layersModel.currentLayer,l.currentPlane,l.currentCamera)}),(0,$.U5)(function(){return console.log("layer swap reaction"),l.layersModel.layers.find(function(e){return e.active})},function(e,t,n){if(console.log("layer changed - Instr controller",null==e?void 0:e._id),e){var r=e._disabledInstruments;if(l.instrumentsModel.instruments.forEach(function(e,t){"top"===e.lvl&&(r.includes(e.id)?l.adapter.setInstrumentAvailable(e.id,!1):l.adapter.setInstrumentAvailable(e.id,!0))}),t&&e._id!==t._id){var o=l.instrumentsModel.instruments.find(function(e){return e.isActive&&"continous"===e.activity});if(!o)return;l.adapter.toggleInstrumentActive(o.id)}}})},this.layersModel=a,this.adapter=new ea(s),this.instrumentsModel=s,this.instruments={line:new te(t,0,n,i),pLine:new te(t,1,n,i),polygon:new tt(t,n,i),selector:new e0(t,n,this.adapter)},this.currentToolId=void 0,this.helpersManager=null,this.currentCamera=r,this.currentPlane=o,this._storeSubscribe()},tl=function e(){(0,y._)(this,e),this.renderer=new E.M,this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.pointerEvents="none",document.body.appendChild(this.renderer.domElement)},tc=function(){function e(t){(0,y._)(this,e),this.layersAdapter=new ez}return e.prototype.init=function(){this.layersAdapter.toggleLayerActive(2)},e}(),td=function e(t){(0,y._)(this,e),this.renderer=new P.CP7({canvas:t,antialias:!0}),this.renderer.shadowMap.enabled=!0,this.renderer.setClearColor(15658734),this.activeElement=this.renderer.domElement,this.rect=t.getBoundingClientRect()},tu=function e(){(0,y._)(this,e),this.getAllSceneObjs=function(e){return e.traverse(function(e){e.layers.isEnabled(2)&&console.log(e.id)}),[]},this.getObjsByLayer=function(e,t){var n=[];return e.children.forEach(function(e){e.layers.mask===t&&n.push(e)}),n}},tp=function e(){var t=this;(0,y._)(this,e),this.onObjAdded=function(e){en(e.userData)&&(console.log("onObjAdded main",e),t.generatorAdapter.setGenerationTask(e,e.userData.layerId.value,"add"),t._registerLayerObjsChange("add",e.userData.layerId.value),t._onUpdCalculatedProps(e,e.userData.layerId.value))},this.onObjRemoved=function(e){en(e.userData)&&t._registerLayerObjsChange("remove",e.userData.layerId.value)},this.onObjPropChanged=function(e){console.log("PROP CHANGED:",e)},this._registerLayerObjsChange=function(e,n){t.layersAdapter.updLayerObjsCount("add"===e?1:-1,n)},this._onUpdCalculatedProps=function(e,n){t.propsEditor.updObjAutoProps(e,n)},this.layersAdapter=new ez,this.generatorAdapter=new tn,this.sceneGetter=new tu,this.propsEditor=new eW},tm=function e(t){var n=this;(0,y._)(this,e),this.addObj=function(e){n.objWatcher.onObjAdded(e),n.scene.add(e)},this.addObjs=function(){for(var e,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=n.scene).add.apply(e,(0,eH._)(r))},this.addUtilObjs=function(e){var t;(t=n.scene).add.apply(t,(0,eH._)(e))},this.removeObj=function(e){n.objWatcher.onObjRemoved(e),n.scene.remove(e)},this.removeObjs=function(){for(var e,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=n.scene).remove.apply(e,(0,eH._)(r))},this._initSceneTempGeometry=function(){n.scene.add(L,X,H),L.material.color.setHex(6842472)},this.scene=t,this.objWatcher=new tp},t_=function(){function e(t){var n=this;(0,y._)(this,e),this.startPointerCoordsUpd=function(e,t,r){e.addEventListener("pointermove",function(o){return n.onUpdPointerCoords(o,e,t,r)})},this.onUpdPointerCoords=function(e,t,r,o){var a=eX(e,t.getBoundingClientRect(),t,r,o);n.pointerCoords.x=a.x,n.pointerCoords.y=a.y,n.pointerCoords.z=a.z,n.adapter.setPointerCoords(n.pointerCoords)},this._scene=new P.xsS,this.sceneModel=t,this.modifier=new tm(this._scene),this.adapter=new eY,this.pointerCoords={x:0,y:0,z:0},this.modifier._initSceneTempGeometry()}return e.prototype.updateSceneStage=function(e,t,n){var r=t>(n||0);this.adapter.setStage(e,t,r)},e}(),tf=new P.VLJ(5e3,5e3,4892927,12829635);tf.position.y=-.01,tf.position.x=0,tf.visible=!1;var th=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gridHelper",n=new P.VLJ(5e3,5e3/e,4892927,12829635);return n.name=t,n},tb=function e(t,n){var r=this;(0,y._)(this,e),this.toggleGridVisibility=function(e){r.gridHelper.visible=e},this._storeSubscribe=function(){(0,$.U5)(function(){var e=r.envModel._getItem(ee.po.GRID_VIS);return e?e.isActive:null},function(e,t){null!==e&&null!==t&&e!==t&&r.toggleGridVisibility(e)})},this.sceneModifier=t,this.envModel=n,this.axesHelper=new P.y8_(10),this.gridHelper=th(10),this.sceneModifier.scene.background=new P.Ilk(11788031),this.sceneModifier.addUtilObjs([W,Z,q]),this.sceneModifier.addUtilObjs([this.axesHelper]),this.sceneModifier.addUtilObjs([this.gridHelper]),this._storeSubscribe()},tg=function e(t,n,r,o,a,s,i){var l=this;(0,y._)(this,e),this.updateCamera=function(e){l.cameraController.setCamera(e),l.instrumentsController.updateCurrentCamera(l.cameraController.camera)},this._storeSubscribe=function(){(0,$.U5)(function(){return l.cameraModel.currentCameraId},function(e,t,n){l.updateCamera(e)}),(0,$.U5)(function(){var e;return null===(e=l.layersModel.getLayerById(2))||void 0===e?void 0:e.objsQuantity},function(e,t,n){void 0!==e&&(1===e?(console.log("layer BORDER obj added",l.layersModel.currentLayer._id),l.sceneController.updateSceneStage(l.layersModel.currentLayer._id,e,t)):0===e&&(console.log("layer BORDER obj 0",l.layersModel.currentLayer._id),l.sceneController.updateSceneStage(l.layersModel.currentLayer._id,e,t)))}),(0,$.U5)(function(){var e;return null===(e=l.layersModel.getLayerById(3))||void 0===e?void 0:e.objsQuantity},function(e,t,n){void 0!==e&&(2===e||1===e)&&(console.log("layer BORDER streets trigger",l.layersModel.currentLayer._id,e),l.sceneController.updateSceneStage(l.layersModel.currentLayer._id,e,t))})},this.cameraController=t,this.instrumentsController=n,this.layersController=r,this.sceneController=o,this.layersModel=a,this.cameraModel=s,this.instrumentsModel=i,this._storeSubscribe()},tv=function(){function e(t){(0,y._)(this,e),this.generatorService=new ts,this.generatorModel=t,this._storeSubscribe()}var t=e.prototype;return t.setOnAddGeneration=function(e,t,n){"parallel"===n&&this.generatorService.createParallelLines(e,t)},t._storeSubscribe=function(){var e=this;(0,$.U5)(function(){return e.generatorModel.currentTask},function(t,n){t&&(console.log("reaction",t.creationType),"generation_on_add"===t.creationType&&e.setOnAddGeneration(t.inputObj,t.objLayerId,t.template))})},e}(),tj=function(){function e(t,n,r,o,a,s,i,l){(0,y._)(this,e),this.groundPlane=K,this.rendererController=new td(t),this.labelRendererController=new tl,this.sceneController=new t_(a),this.sceneEnvController=new tb(this.sceneController.modifier,s),this.layersController=new tc(n),this.cameraController=new et(this.rendererController,n,i),this.instrumentsController=new ti(this.rendererController.activeElement,this.sceneController.modifier,this.cameraController.camera,this.groundPlane,n,r,o),this.commonController=new tg(this.cameraController,this.instrumentsController,this.layersController,this.sceneController,n,i,r),this.generatorController=new tv(l),this.stats=(0,O.Z)(),this.stats.update(),this.update(),this.sceneController.startPointerCoordsUpd(this.rendererController.activeElement,this.cameraController.camera,this.groundPlane),this.initLayers(),console.log("scene constr")}var t=e.prototype;return t.initLayers=function(){this.layersController.init()},t.onWindowResize=function(e,t){this.rendererController.renderer.setSize(e,t,!1);var n=e/t;this.cameraController.updOnResize(n,200),this.labelRendererController.renderer.setSize(e,t)},t._storeSubscribe=function(){},t.update=function(){this.labelRendererController.renderer.render(this.sceneController.modifier.scene,this.cameraController.camera),this.rendererController.renderer.render(this.sceneController.modifier.scene,this.cameraController.camera),requestAnimationFrame(this.update.bind(this)),this.cameraController.controls.update(),this.stats.update()},e}(),ty=(0,v.Pi)(function(e){return(0,g.jsx)(eL.pS,{isSelected:!!e.isOpened,isExpandable:!0,iconKey:"sceneEnv",isActive:!1,title:"Scene Options"})}),tO=[{id:ee.po.GRID_SIZE,type:"grid",title:"Size",isActive:!0,options:{controller:"range",defaultValue:10,value:10,rangeTitle:"size",rangeMin:1,rangeMax:100,rangeStep:5,selVariants:[],selValues:[]}},{id:ee.po.GRID_VIS,type:"grid",title:"Visibility",isActive:!0,options:{controller:"none",value:0,rangeMin:0,rangeMax:0,rangeStep:0,selVariants:[],selValues:[]}},{id:ee.po.GRID_COLOR,type:"grid",title:"Color",isActive:!0,options:{controller:"none",defaultValue:10,value:0,rangeMin:0,rangeMax:0,rangeStep:0,selVariants:[],selValues:[]}},{id:ee.po.GRID_DIST,type:"grid",title:"Distance",isActive:!0,options:{controller:"range",value:1e3,defaultValue:1e3,rangeMin:100,rangeMax:1e4,rangeStep:100,selVariants:[],selValues:[]}}],tP=new function e(){var t=this;(0,y._)(this,e),this.toggleSceneEnvItemOptionIsActive=function(e){var n=t._getItem(e);n&&(n.isActive=!n.isActive)},this.setItemValue=function(e,n){var r=t._getItem(e);if(r){if("range"===r.options.controller)r.options.value=n;else if("selection"===r.options.controller){var o=r.options.selValues.indexOf(n);o>-1?r.options.selValues=(0,eH._)(r.options.selValues.slice(0,o)).concat((0,eH._)(r.options.selValues.slice(o+1))):r.options.selValues.push(n)}}},this._getItem=function(e){return t.sceneEnvOptions.find(function(t){return t.id===e})},this.sceneEnvOptions=tO,(0,$.ky)(this)},tw=(0,v.Pi)(function(e){var t=e.envItemId,n=tP._getItem(t);if(!n)return null;var r=function(){tP.toggleSceneEnvItemOptionIsActive(t)},o=function(e){var n=parseInt(e.target.value);isNaN(n)||tP.setItemValue(t,n)},a=function(e){tP.setItemValue(t,e)},s=(0,v.Pi)(function(){return"range"===n.options.controller?(0,g.jsx)(eL.Fo,{minVal:n.options.rangeMin,maxVal:n.options.rangeMax,stepVal:n.options.rangeStep,val:n.options.value,valName:n.options.rangeTitle,onSliderChange:o}):"selection"===n.options.controller?(0,g.jsx)(eL.Kj,{items:n.options.selVariants,selected:n.options.selValues,handleCollectionUpd:a}):null});return(0,g.jsx)(eL.Ph,{title:n.title,isChecked:n.isActive,onDoubleClick:function(){return r()},children:(0,g.jsx)(s,{})})}),tE=(0,v.Pi)(function(){var e=tP.sceneEnvOptions,t=e.reduce(function(e,t){if(e.includes(t.type))return e;var n=(0,eH._)(e);return n.push(t.type),n},[]);return(0,g.jsx)(eL.Zb,{children:t.map(function(t){return(0,g.jsx)(eL.dJ,{header:t,children:e.map(function(e){if(e.type===t)return(0,g.jsx)(tw,{envItemId:e.id},e.id)})},t)})})}),tC=n(174),tT=n.n(tC),tM=new function e(){var t=this;(0,y._)(this,e),this.setCameraView=function(e){t.currentCameraId=e,console.log("CHANGED CAMERA TO",e)},this.currentCameraId=ee.A2.PERSPECTIVE,(0,$.ky)(this)},tS=(0,v.Pi)(function(e){var t=e.viewId,n=tM.currentCameraId;return(0,g.jsx)(eL.pS,{iconKey:t===ee.A2.PERSPECTIVE?"cameraPerspective":"cameraTop",isActive:n===t,title:t===ee.A2.PERSPECTIVE?"Perspective View":"Top View",onClick:function(){return tM.setCameraView(t)}})}),tB=function(e){var t=(0,j.useRef)(null);return(0,j.useLayoutEffect)(function(){var n=null==t?void 0:t.current;if(n){var r=new ResizeObserver(function(t){e(n,t[0])});return r.observe(n,{box:"content-box"}),function(){r.disconnect()}}},[e,t]),console.log("inside resize observer",t),t},tL=function(){var e=(0,b._)((0,j.useState)(!1),2),t=e[0],n=e[1],r=(0,j.useRef)(null),o=(0,j.useRef)(null),a=tB((0,j.useCallback)(function(e,t){o.current&&o.current.onWindowResize(t.contentRect.width,t.contentRect.height)},[o.current,t]));return(0,j.useEffect)(function(){if(t){var e=a.current;e&&(o.current=new tj(e,eB,ek.T0,ek.zl,eA,tP,tM,eF))}},[t]),(0,j.useEffect)(function(){n(!0)},[]),(0,g.jsx)("div",{ref:r,className:tT().desk,children:(0,g.jsx)("canvas",{ref:a,className:tT().canvasScene,id:"canvasScene"})})},tI=n(8378),tk=n.n(tI);n(1510);var tx={0:null,2:null,3:{objWidth:{controlType:"slide",minVal:1,maxVal:100,step:1}},4:null,5:null},tN=(0,v.Pi)(function(){var e,t;return(0,g.jsxs)("div",{className:tk().leftBar,children:[(0,g.jsx)(eL.O,{header:"Layers",children:eB.layers.map(function(e){return(0,g.jsx)(eI,{layerId:e._id,name:e._name,isEmpty:e.empty,isBlocked:e.blocked,isActive:e.active,isVisible:e.visible,numOfObjs:e.objsQuantity},e._id)})}),(0,g.jsx)(eL.O,{header:"Object Properties",children:(null===(e=ek.T0.currentInstrument)||void 0===e?void 0:e.id)===ee.aU.SELECTOR?(t=ek.T0.instrumentsData.inspector.selectedObjData||ek.T0.instrumentsData.inspector.intersectedObjData)?(0,g.jsx)(g.Fragment,{children:Object.keys(t).map(function(e,n){var r=t[e];if("object"==typeof r&&r&&r.pubTitle){var o=tx[t.layerId.value];return(0,g.jsx)(ek.Q5,{propId:e,propName:r.pubTitle,propValue:r.value,isEditable:"editable"===r.editType,controls:o},e)}})}):(0,g.jsx)(g.Fragment,{children:"..."}):"Use Selector to select an object from the scene"}),(0,g.jsx)(eL.O,{children:(0,g.jsx)(eG,{})})]})}),tA=n(3185),tD=n.n(tA),tR=(0,v.Pi)(function(){return(0,g.jsx)("div",{className:tD().rightBar,children:(0,g.jsx)(eL.O,{header:"Analysis",children:"There will be analysis instruments"})})}),tJ=n(4484),tG=n.n(tJ),tF=n(1783),tV=n(6861),tz=(0,v.Pi)(function(e){var t=e.className,n=(0,ec._)(e,["className"]),r=(0,eL.pA)(ek.FS),o=(0,eL.pA)(ek.Uq),a=(0,eL.pA)(ty);return(0,g.jsxs)("div",(0,el._)((0,ei._)({className:eu()(t,tG().topBar)},n),{children:[(0,g.jsxs)("div",{className:tG().corner,children:[(0,g.jsx)("span",{className:tG().corner__logo,children:(0,g.jsx)(tV.Z,{})}),(0,g.jsx)(eL.pS,{title:"Import",isActive:!1})]}),(0,g.jsxs)("div",{className:tG().main,children:[(0,g.jsxs)("div",{className:tG().main__part,children:[(0,g.jsx)(ek.yw,{}),(0,g.jsx)(r,{wrapped:(0,g.jsx)(tF.s,{menuType:"drawing"})}),(0,g.jsx)(o,{wrapped:(0,g.jsx)(tF.s,{menuType:"helpers"}),contentClickType:"double"})]}),(0,g.jsxs)("div",{className:tG().main__part,children:[(0,g.jsx)(tS,{viewId:ee.A2.PERSPECTIVE}),(0,g.jsx)(tS,{viewId:ee.A2.TOP}),(0,g.jsx)(eL.pS,{iconKey:"viewAll",isActive:!1}),(0,g.jsx)(eL.pS,{iconKey:"viewCenter",isActive:!1})]}),(0,g.jsx)("div",{className:tG().main__part,children:(0,g.jsx)(eL.pS,{iconKey:"viewAll",isActive:!1,title:"Clear Scene",onClick:function(){}})})]}),(0,g.jsx)("div",{className:tG().utils,children:(0,g.jsx)(a,{wrapped:(0,g.jsx)(tE,{}),contentClickType:"double"})})]}))}),tY=n(3653),tU=n.n(tY),tX=n(6531),tK=n.n(tX),tH=(0,v.Pi)(function(){var e=eA.stages;return(0,g.jsx)("div",{className:tK().stages,children:(0,g.jsx)("span",{className:tK().ptsWrap,children:e.map(function(e){var t,n,r,o,a;return(0,g.jsxs)("div",{className:eu()(tK().line,(t={},(0,es._)(t,tK().start,"start"===e.id),(0,es._)(t,tK().completed,"completed"===e.status),(0,es._)(t,tK().current,"current"===e.status),t)),children:[(0,g.jsx)("div",{className:eu()(tK().ptOuter,(n={},(0,es._)(n,tK().completed,"completed"===e.status),(0,es._)(n,tK().current,"current"===e.status),n))}),(0,g.jsx)("div",{className:eu()(tK().ptInner,(r={},(0,es._)(r,tK().completed,"completed"===e.status),(0,es._)(r,tK().current,"current"===e.status),r))}),(0,g.jsxs)("div",{className:eu()(tK().icon,(o={},(0,es._)(o,tK().completed,"completed"===e.status),(0,es._)(o,tK().current,"current"===e.status),o)),children:[(0,g.jsx)("svg",{children:(0,g.jsx)("use",{href:"/icons/stage_bundle.svg#".concat(e.id),className:"stages__ptsWrap__icon__svg"})}),(0,g.jsx)("div",{className:eu()(tK().txt,(a={},(0,es._)(a,tK().start,"start"===e.id),(0,es._)(a,tK().completed,"completed"===e.status),(0,es._)(a,tK().current,"current"===e.status),a)),children:e.title})]})]},e.id)})})})}),tW=(0,v.Pi)(function(e){var t=e.className,n=(0,b._)((0,j.useState)(!0),2),r=n[0],o=n[1],a=eA.currentStage,s=function(){o(!r)};return(0,g.jsxs)("div",{className:eu()(t,tU().stageBar),children:[(0,g.jsx)("button",{className:tU().btn,onClick:function(){return s()},children:(0,g.jsx)("svg",{children:(0,g.jsx)("use",{href:"/icons/stage_bundle.svg#".concat(null==a?void 0:a.id)})})}),(0,g.jsxs)("span",{className:eu()(tU().bar,(0,es._)({},tU().active,r)),children:[(0,g.jsx)("span",{className:tU().barTail}),(0,g.jsx)(tH,{})]})]})}),tZ=n(253),tQ=n.n(tZ),tq=(0,v.Pi)(function(){var e=(0,b._)((0,j.useState)(!1),2),t=e[0],n=e[1];return(0,j.useEffect)(function(){n(!0)},[]),(0,g.jsx)("div",{className:tQ().appPage,children:t?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(tz,{className:tQ().topBar}),(0,g.jsx)("div",{className:tQ().canvas,children:(0,g.jsx)(tL,{})}),(0,g.jsx)("div",{className:tQ().leftBar,children:(0,g.jsx)(tN,{})}),(0,g.jsx)("div",{className:tQ().rightBar,children:(0,g.jsx)(tR,{})}),(0,g.jsx)(tW,{className:tQ().stageBar}),(0,g.jsx)("div",{className:tQ().version,children:"BLOCKSIFY v0.3.0-shatsk-alpha"})]}):(0,g.jsx)(g.Fragment,{})})})},3370:function(e){e.exports={layersListItem:"layerItem_layersListItem__4GkGp",active:"layerItem_active__uYmZG",hidden:"layerItem_hidden__YfeuT",blocked:"layerItem_blocked__KvLJ9",name:"layerItem_name__sQgV0",name__counter:"layerItem_name__counter__J6jCV",emptyStatus:"layerItem_emptyStatus__lUz3e",nonEmptyBadge:"layerItem_nonEmptyBadge__vd0vb",iconContainer:"layerItem_iconContainer__Z4hDC"}},9798:function(e){e.exports={coordsPanel:"coordsPanel_coordsPanel__qsU4z",coordsPanel__cell:"coordsPanel_coordsPanel__cell__DDIUf"}},6531:function(e){e.exports={stages:"stages_stages__HzWqZ",ptsWrap:"stages_ptsWrap__cdz_m",line:"stages_line__Z8ayN",start:"stages_start__1yzop",current:"stages_current__DHM9E",completed:"stages_completed__Xjekm",ptOuter:"stages_ptOuter__6GXFl",ptInner:"stages_ptInner__Og7vK",icon:"stages_icon__aqoOJ",txt:"stages_txt__kPlGG"}},253:function(e){e.exports={appPage:"appPage_appPage__k3j_x",topBar:"appPage_topBar__chfuf",sideBar:"appPage_sideBar__D8aBl",leftBar:"appPage_leftBar__tFMaB",rightBar:"appPage_rightBar__9cHVJ",canvas:"appPage_canvas__I7FSP",stageBar:"appPage_stageBar__8V_cc",version:"appPage_version__N6KFJ"}},174:function(e){e.exports={desk:"desk_desk__ZmbLZ",canvasScene:"desk_canvasScene__7bdN2"}},8378:function(e){e.exports={leftBar:"leftBar_leftBar__Z4y1e"}},3185:function(e){e.exports={rightBar:"rightBar_rightBar__U6vZU"}},3653:function(e){e.exports={stageBar:"stageBar_stageBar__OHSBz",btn:"stageBar_btn__1Ax6j",bar:"stageBar_bar__1BpbN",active:"stageBar_active__yWkRp",barTail:"stageBar_barTail__LVcW9"}},4484:function(e){e.exports={topBar:"topBar_topBar__04Pjj",corner:"topBar_corner__DA_ay",corner__logo:"topBar_corner__logo__W_Kh9",main:"topBar_main__dtE1q",main__part:"topBar_main__part__d5XBt",utils:"topBar_utils__CRsjf"}}}]);